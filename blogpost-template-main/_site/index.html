<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      IFT6758 Blog Team 12 &middot; Blog post of the nhl data science project
    
  </title>

  
  <link rel="canonical" href="http://localhost:4000/">
  

  <link rel="stylesheet" href="http://localhost:4000/public/css/poole.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/syntax.css">
  <link rel="stylesheet" href="http://localhost:4000/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="http://localhost:4000/public/favicon.ico">

  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:4000/atom.xml">

  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A reserved <a href="https://jekyllrb.com" target="_blank">Jekyll</a> theme that places the utmost gravity on content with a hidden drawer. Made by <a href="https://twitter.com/mdo" target="_blank">@mdo</a>.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item active" href="http://localhost:4000/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="http://localhost:4000/about/">About</a>
        
      
    
      
    

    <a class="sidebar-nav-item" href="/archive/v1.1.0.zip">Download</a>
    <a class="sidebar-nav-item" href="">GitHub project</a>
    <span class="sidebar-nav-item">Currently v1.1.0</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2022. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">IFT6758 Blog Team 12</a>
            <small>Blog post of the nhl data science project</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:4000/2022/11/25/milestone-2/">
        Milestone 2
      </a>
    </h1>

    <span class="post-date">25 Nov 2022</span>

    <h2 id="1---feature-engineering-i">1 - Feature Engineering I</h2>

<h3 id="a-histogram-of-shot-counts-goals-and-no-goals-separated-binned-by-distance">a) Histogram of shot counts (goals and no-goals separated), binned by distance</h3>
<p><img src="assets/1.png" alt="2-111111111" />
The histogram above shows shots vs goals distribution over the distance from the net. Each bar covers 10 meters, and the height indicates the number of shots/goals in each distance range. We can see that the largest shots/goals were in the 5-15 meters range. There’s also a smaller hill whose peak for shots at 35-45 meter range.</p>
<h3 id="b-histogram-of-shot-counts-goals-and-no-goals-separated-binned-by-angle">b) Histogram of shot counts (goals and no-goals separated), binned by angle</h3>
<p><img src="assets/2.png" alt="2-1111111211" />
This time, the histogram shows shots vs goals distribution over the angle from the net. Each bar covers 10 degress, and the height indicates the number of shots/goals in each distance range. We can see that the largest shots were in the 25-35 degress range. and the largest goals at 5-15 degrees.</p>
<h3 id="c-histogram-where-one-axis-is-the-distance-and-the-other-is-the-angle">c) Histogram where one axis is the distance and the other is the angle</h3>
<p><img src="assets/3.png" alt="2-1111113111" />
<img src="assets/4.png" alt="2-1111111411" />
<img src="assets/5.png" alt="2-11111411411" /></p>

<p>A Jointplot comprises three plots. Out of the three, one plot displays a graph which shows how the angle from the net varies with the distance from the net</p>

<p>The above plot displays a scatterplot with two histograms at the margins of the graph. If we observe the scatterplot, there seems to be a negative relationship between the columns distance from the net and angle from the net.
We can also observe that we have an important concentrations of goals with small values of distance and angles.
Most values are concentrated around the left bottom side which means most shots and goals are shot from a near distance from the net.
Outliers are the data points that lie far away from the rest of the data values, in the graph we can see outliers 2 clusters of outliers as well as in the histograms.</p>

<h3 id="a-plot-of-goal-rate-vs-distance-of-shot-">a) Plot of goal rate vs distance of shot :</h3>
<p><img src="assets/6.png" alt="2-11111116411" />
From the plot above, we can notice that the goal ratio is about 20% when we are at a small distance (less than 10 meters) from the net. The goal ratio decreases when we start going far from the net. We can see that the smallest value is achieved when the distance is between 40 and 80 i.e. when we are far from the net. We can also notice that the goal ratio increases after the bin 80-90 i.e. when the shots are shot from the opposite rink side, we can consider these shots as outliers as they are events that occur rarely.</p>
<h3 id="b-plot-of-angle-rate-vs-distance-of-shot-">b) Plot of angle rate vs distance of shot :</h3>
<p><img src="assets/7.png" alt="2-11111117411" />
From the plot above, we can observe that the goal ratio is about 15% when we are in front of the net (less than 0-20 degrees) . The goal ratio decreases as we move away from the center of y. Qe can say that the worst angle to shoot from it is 50-80 and the best angle to obtain a goal is 0-20. We can also notice that the goal ratio increases after the bin 80-90 i.e. when the shots are shot from above the net, we can consider these shots as outliers as they are events that occur rarely.</p>
<h3 id="c-histogram-of-goals-binned-by-distance-with-separate-empty-net-and-non-empty-net-events-">c) Histogram of goals, binned by distance, with separate empty net and non-empty net events :</h3>
<p><img src="assets/8.png" alt="2-11111118411" />
Non Empty net :
<img src="assets/9.png" alt="2-11119111411" /></p>

<p>Empty net :
<img src="assets/10.png" alt="2-111111111411" />
We can say that when the net is not empty, we have a better chance to goal when we shot from a distance between 7 and 15 and then our chances decreases. But when the net is empty, the chances increases for all kind of shots especially the ones in 10-20 meters</p>

<h2 id="2---baseline-models">2 - Baseline Models</h2>

<p>We use simple models like logistic regression to perform classification. We generated following
models:</p>
<h3 id="a-using-distance-as-feature">a) Using distance as feature:</h3>
<p>We applied logistic regression with input feature as distance and output/label as is_goal.
We got the accuracy of 91% precision score 0.91 and Fscore 0.95. This means it can predict 91
out of 100 inputs correctly.
<img src="assets/har11.png" alt="1-1" />
<img src="assets/har12.png" alt="1-2" />
<img src="assets/har13.png" alt="1-3" />
<img src="assets/har14.png" alt="1-4" /></p>

<h3 id="b-using-angle-as-feature">b) Using angle as feature:</h3>
<p>We applied logistic regression with input feature as angle and output/label as is_goal.
We got the accuracy of 91% precision score 0.91 and Fscore 0.95. This means it can predict 91
out of 100 inputs correctly.
<img src="assets/har21.png" alt="2-1" />
<img src="assets/har22.png" alt="2-2" />
<img src="assets/har23.png" alt="2-3" />
<img src="assets/har24.png" alt="2-4" /></p>

<h3 id="c-using-angle-and-distance-as-features">c) Using angle and distance as features:</h3>
<p>We applied logistic regression with input feature as distance and output/label as is_goal.
We got the accuracy of 91% precision score 0.91 and Fscore 0.95. This means it can predict 91
out of 100 inputs correctly.</p>

<p><img src="assets/har31.png" alt="3-1" />
<img src="assets/har32.png" alt="3-2" />
<img src="assets/har33.png" alt="3-3" />
<img src="assets/har34.png" alt="3-4" /></p>

<p>We quickly come to the conclusion that the logistic regression model consistently predicts goals,
regardless of the features used. It implies that a more sophisticated model must be taken into
account for this binary classification, which will be investigated in Tasks 5 and 6. We even
contrast the non-learning statistical method with the log-reg.</p>
<h2 id="3---feature-engineering-ii">3 - Feature Engineering II</h2>
<p>List of all of the features created for this section are :</p>
<ul>
  <li>Y_net : the y  coordinates of the net of the opposing team</li>
  <li>X_net	: the x  coordinates of the net of the opposing team</li>
  <li>last_EventType : the previous event type before a shot or goal was made.</li>
  <li>last_period : the period when the previous event occurred</li>
  <li>last_periodTime : the time when the previous event occurred</li>
  <li>last_eventxCoord : the x coordinate of the previous event</li>
  <li>last_eventyCoord : the y coordinate of the previous event</li>
  <li>last_shotType : the type of the previous event</li>
  <li>last_periodSeconds : the time in seconds of the previous event</li>
  <li>last_Distance_from_net : the distance from the net of the opposing team of the previous event</li>
  <li>last_Angle_from_net : the angle from the net of the opposing team of the previous event</li>
  <li>time_from_last_event : the time between the current shot/ goal and the the event that occurred before</li>
  <li>distance_from_last_event : the distance between the current goal/shot and the previous shot/event</li>
  <li>rebound : a flag that indicates if the previous event is a shot or not</li>
  <li>change_in_angle : the angle beween the previous event and the current shot/goal.</li>
  <li>
    <p>speed : the speed of the events ( the distance from the previous event, divided by the time since the previous event.)</p>
  </li>
  <li>Link to the experiment which stores the filtered DataFrame artifact for the specified game :
https://www.comet.com/yasmine/ift6758-a22-milestone-2/b6742c589a64401d843cb0766cbce801?assetId=0b219e7f221d4e7ca6bff8537d0834a2&amp;assetPath=dataframes&amp;experiment-tab=assets
    <h2 id="4---advanced-models">4 - Advanced Models</h2>
  </li>
</ul>

<h3 id="a-question-1-">a) Question 1 :</h3>
<p><img src="assets/megha1.png" alt="6-6" /></p>

<p>The baseline xgboost model is trained on the “Distance” and “Angle” features obtained post implementing feature engineering 1. The model is trained with a learning rate of 0.1, a maximum depth of 7 and the number of estimators are taken as 5000. The subsampling is set as 0.5 . The trained accuracy obtained through such a model is 0.7255 while the validation accuracy is 0.7144
 The validation set is 20% and the training set is 80% of the actual training set provided. The accuracy / prediction is much better using the xgboost as compared to the logistics regression baseline model.
<img src="assets/megha11.png" alt="4-1" />
<img src="assets/megha13.png" alt="4-2" />
<img src="assets/megha14.png" alt="4-3" />
<img src="assets/megha15.png" alt="4-4" />
<img src="assets/megha16.png" alt="4-5" /></p>

<h3 id="b-question-2-">b) Question 2 :</h3>
<p>Post preprocessing the data to remove null values in the entire dataset and infinite values in the speed column, we tune the hyperparameters with the following parameters using Grid SearchCV.
learning_rate_list=[0.02,0.05,0.1]
max_depth_list =[5,7,10]
n_estimators_list = [2000, 3000,5000]</p>

<p>Below is the table obtained to get compare and rank the combination of characters that provide the highest accuracy.
<img src="assets/megha2.png" alt="6-2" /></p>

<p>We further plot curves to infer the parameter that provide the highest accuracy.
The graphs are shown below:
<img src="assets/megha21.png" alt="4-21" /></p>

<p>From the above figure, we can conclude that validation accuracy decreases as we increase the number of estimators and the depth of the tree for our data.
<img src="assets/megha22.png" alt="4-22" />
We can conclude from the above figure that the validation accuracy decreases as we increase the learning rate.
The new tuned model is obtained by using the following parameters:
learning_rate=0.02,
max_depth=6,
n_estimators=2000,
subsample=1,colsample_bytree=1
The accuracy thus obtainedare :
AUC Train: 0.7268
AUC Valid: 0.6767
The new tuned model is trained on the data obtained from feature engineering 2 and thus have different features as from the baseline model. The accuracy is almost equal to or lower than the XGBoost baseline model.
<img src="assets/megha23.png" alt="4-23" /></p>

<p>train and validation AUC increases as no of trees increases
<img src="assets/megha24.png" alt="4-24" /></p>

<p>The confusion matrix for the results of the tuned model.
Below is the Classification report of the tuned model:
<img src="assets/megha25.png" alt="4-25" />
<img src="assets/megha26.png" alt="4-26" />
<img src="assets/megha27.png" alt="4-27" />
<img src="assets/megha28.png" alt="4-28" />
<img src="assets/megha210.png" alt="4-210" /></p>
<h3 id="c-question-3-">c) Question 3 :</h3>
<p>The importance of features is given by the below table:
<img src="assets/megha31.png" alt="4-31" />
SHAP is used to keep a track of  the contribution of features in increasing or decreasing the performance of the model Here are some of the figures obtained through SHAP.
<img src="assets/megha32.png" alt="4-32" />
<img src="assets/megha33.png" alt="4-33" />
<img src="assets/megha34.png" alt="4-34" />
<img src="assets/megha35.png" alt="4-35" />
<img src="assets/megha36.png" alt="4-36" />
<img src="assets/megha37.png" alt="4-37" />
Features pushing the prediction higher are shown in red, those pushing the prediction lower are in blue.
The selected features from the above figures(‘time_from_last_event’,,’speed’,’last_Angle_from_net’,’last_period’,’last_Distance_from_net’
) were fed to the XGBoost model and the validation accuracy thus obtained is validation_0-auc:0.63307
The model did not perform better than the XGBoost baseline and the XGboost tuned model with the full set of features. We can hence conclude that decreasing the features in the provided dataset did not increase the accuracy. And training the model on Distance and Angle performed better and gave the best results among Logistic Regression models and the XGBoost models.</p>

<h2 id="5---give-it-your-best-shot">5 - Give it your best shot!</h2>
<p>In this part, we choose to work with Neural networks. below the methods used :</p>
<h3 id="a-eda-exploratory-data-analysis-">a) EDA (Exploratory Data Analysis) :</h3>
<p>We started by analyzing the missing values :
<img src="assets/kh51.png" alt="5-51" /></p>

<p>More than 80% of the values are missing for some features, so we decided to drop these features.</p>

<p>In the figure below, we can see the correlation map between our features :
<img src="assets/kh52.png" alt="5-52" />
There are no high correlation between our features, we can keep all of them for now.</p>

<p>We can do more feature engineering in this par.</p>
<h3 id="b-feature-engineering-">b) Feature engineering :</h3>
<h4 id="1-data-encoding-">1) Data encoding :</h4>
<ul>
  <li>the periodType contains 3 values : OVERTIME, REGULAR and SHOOTOUT, we decided to use a OneHotEncoder.
<img src="assets/kh53.png" alt="5-53" /></li>
  <li>The second categorical feature is teamOfShooter, for this feature, we decided to use : LeaveOneOutEncoder because we have a nominal feature, with lot of teams and also to avoid overfitting
<img src="assets/kh54.png" alt="5-54" /></li>
  <li>We have different shot type :
<img src="assets/kh50.png" alt="5-50" /></li>
  <li>For our last categorical feature : shotType, we decided to use an OrdinalEncoder becasue the order matter here, as we saw in the previous milestone
<img src="assets/kh55.png" alt="5-55" /></li>
</ul>

<h4 id="2-feature-selection-">2) Feature selection :</h4>
<p>In this part, we used ExtraTreesClassifier as a feature selection method.
The feature selection is used to make the process more accurate. It also increases the prediction power of the models by selecting the most critical variables and eliminating the redundant and irrelevant ones.
<img src="assets/kh56.png" alt="5-56" /></p>
<h4 id="3-data-standardization-">3) Data standardization :</h4>
<p>The goal of using data standardization is to bring down all the features to a common scale
without distorting the differences in the range of the values.
It will help training of our neural networks as the different features are on a similar scale and help it to converge faster.</p>
<h4 id="4-imbalanced-data-">4) Imbalanced data :</h4>
<p>From the plot below, we can see that our data is imbalanced. Thus, our model will always get high accuracy since if it predicts all the rows as class 0. To deal with this, we decided to use SMOTE method</p>
<ul>
  <li>SMOTE works by selecting examples that are close in the feature space, drawing a line between the examples in the feature space and drawing a new sample at a point along that line.
<img src="assets/kh57.png" alt="5-57" />
    <h3 id="b-model-training-">b) Model training :</h3>
    <p>Below the metrics we choose to evaluate the model:</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">METRICS</span> <span class="o">=</span> <span class="p">[</span>
      <span class="n">keras</span><span class="p">.</span><span class="n">metrics</span><span class="p">.</span><span class="n">TruePositives</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'tp'</span><span class="p">),</span>
      <span class="n">keras</span><span class="p">.</span><span class="n">metrics</span><span class="p">.</span><span class="n">FalsePositives</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'fp'</span><span class="p">),</span>
      <span class="n">keras</span><span class="p">.</span><span class="n">metrics</span><span class="p">.</span><span class="n">TrueNegatives</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'tn'</span><span class="p">),</span>
      <span class="n">keras</span><span class="p">.</span><span class="n">metrics</span><span class="p">.</span><span class="n">FalseNegatives</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'fn'</span><span class="p">),</span>
      <span class="n">keras</span><span class="p">.</span><span class="n">metrics</span><span class="p">.</span><span class="n">BinaryAccuracy</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'accuracy'</span><span class="p">),</span>
      <span class="n">keras</span><span class="p">.</span><span class="n">metrics</span><span class="p">.</span><span class="n">Precision</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'precision'</span><span class="p">),</span>
      <span class="n">keras</span><span class="p">.</span><span class="n">metrics</span><span class="p">.</span><span class="n">Recall</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'recall'</span><span class="p">),</span>
      <span class="n">keras</span><span class="p">.</span><span class="n">metrics</span><span class="p">.</span><span class="n">AUC</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'auc'</span><span class="p">),</span>
      <span class="n">keras</span><span class="p">.</span><span class="n">metrics</span><span class="p">.</span><span class="n">AUC</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">'prc'</span><span class="p">,</span> <span class="n">curve</span><span class="o">=</span><span class="s">'PR'</span><span class="p">),</span> <span class="c1"># precision-recall curve
</span><span class="p">]</span>
</code></pre></div></div>

<p>We used the Sequential API to build the model</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># build a model
</span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],),</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span> <span class="c1"># Add an input shape! (features,)
</span><span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>

<span class="c1"># compile the model
</span><span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'Adam'</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="s">'binary_crossentropy'</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="n">METRICS</span><span class="p">)</span>

<span class="c1"># early stopping callback
# This callback will stop the training when there is no improvement in
# the validation loss for 10 consecutive epochs.
</span><span class="n">es</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s">'val_accuracy'</span><span class="p">,</span>
                                   <span class="n">mode</span><span class="o">=</span><span class="s">'max'</span><span class="p">,</span> <span class="c1"># don't minimize the accuracy!
</span>                                   <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                   <span class="n">restore_best_weights</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># now we just update our model fit call
</span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span>
                    <span class="n">y</span><span class="p">,</span>
                    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">es</span><span class="p">],</span>
                    <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                    <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>We also used an early stopping callback that will stop the training when there is no improvement in the validation loss for 10 consecutive epochs.
<img src="assets/kh58.png" alt="5-58" /></p>
<h3 id="b-results-">b) Results :</h3>
<p><img src="assets/kh61.png" alt="5-61" />
<img src="assets/kh62.png" alt="5-62" />
<img src="assets/kh63.png" alt="5-63" />
<img src="assets/kh64.png" alt="5-64" />
<img src="assets/kh65.png" alt="5-65" />
<img src="assets/kh66.png" alt="5-66" />
<img src="assets/kh67.png" alt="5-67" />
<img src="assets/kh68.png" alt="5-68" /></p>

<p>The neural network model given below was built on a 80% random sample of the shots and
goasl, and validated on the 20% held out. The model did not over fit the training dataset and was deemed appropriate.
Saving to comet-ml :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create an experiment with your api key
</span><span class="n">comet_exp6</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span>
    <span class="n">api_key</span><span class="o">=</span><span class="s">"LgN3RhQfuVAcQnKyC9X0Gk1PC"</span><span class="p">,</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s">"ift6758-a22-milestone-2"</span><span class="p">,</span>
    <span class="n">workspace</span><span class="o">=</span><span class="s">"yasmine"</span><span class="p">,</span>
    <span class="n">log_code</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># save the model to disk
</span><span class="n">filename</span> <span class="o">=</span> <span class="s">'../models/TryBestShot_bestmodel.sav'</span>
<span class="n">pickle</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">))</span>
<span class="n">comet_exp6</span><span class="p">.</span><span class="n">log_model</span><span class="p">(</span><span class="s">"Try best shot6"</span><span class="p">,</span> <span class="s">'../models/TryBestShot_bestmodel.sav'</span><span class="p">)</span>
<span class="n">comet_exp6</span><span class="p">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s">"accuracy"</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">preds</span><span class="p">))</span>
<span class="c1">#these will all get logged
</span><span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s">'batch_size'</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="s">'epochs'</span><span class="p">:</span><span class="mi">27</span><span class="p">,</span>
        <span class="s">'layer_num'</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
        <span class="s">'optimizer'</span><span class="p">:</span><span class="s">'adam'</span><span class="p">,</span>
        <span class="s">'patience'</span><span class="p">:</span><span class="mi">10</span>
<span class="p">}</span>
<span class="n">comet_exp6</span><span class="p">.</span><span class="n">log_parameters</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<span class="n">comet_exp6</span><span class="p">.</span><span class="n">log_dataframe_profile</span><span class="p">(</span>
<span class="n">X</span><span class="p">,</span>
<span class="n">name</span><span class="o">=</span><span class="s">'df_smote'</span><span class="p">,</span>  <span class="c1"># keep this name
</span><span class="n">dataframe_format</span><span class="o">=</span><span class="s">'csv'</span>  <span class="c1"># ensure you set this flag!
</span><span class="p">)</span>
</code></pre></div></div>

<p>links to experiments :</p>
<ul>
  <li>https://www.comet.com/yasmine/ift6758-a22-milestone-2/355986f89fc74eb0b54d19099ae3c242?experiment-tab=chart&amp;showOutliers=true&amp;smoothing=0&amp;transformY=smoothing&amp;xAxis=wall</li>
  <li>https://www.comet.com/yasmine/ift6758-a22-milestone-2/21355c4d9aae4381adefa20db7738efe?experiment-tab=chart&amp;showOutliers=true&amp;smoothing=0&amp;transformY=smoothing&amp;xAxis=wall</li>
  <li>https://www.comet.com/yasmine/ift6758-a22-milestone-2/62e5259bcbe3444780c8f3ed8edb8577?experiment-tab=chart&amp;showOutliers=true&amp;smoothing=0&amp;transformY=smoothing&amp;xAxis=wall</li>
  <li>https://www.comet.com/yasmine/ift6758-a22-milestone-2/26f5adae91814c9795c79958404f710d?experiment-tab=chart&amp;showOutliers=true&amp;smoothing=0&amp;transformY=smoothing&amp;xAxis=wall</li>
  <li>https://www.comet.com/yasmine/ift6758-a22-milestone-2/5b6ecf5ce6c048a5b66d3e26d668198d?experiment-tab=chart&amp;showOutliers=true&amp;smoothing=0&amp;transformY=smoothing&amp;xAxis=wall</li>
  <li>https://www.comet.com/yasmine/ift6758-a22-milestone-2/76ff849af73a4310969ff68800e882d4?experiment-tab=chart&amp;showOutliers=true&amp;smoothing=0&amp;transformY=smoothing&amp;xAxis=wall</li>
  <li>https://www.comet.com/yasmine/ift6758-a22-milestone-2/650ae41436dd4ce5935da01d49d7e80d?experiment-tab=chart&amp;showOutliers=true&amp;smoothing=0&amp;transformY=smoothing&amp;xAxis=wall
    <h2 id="6---evaluate-on-test-set-">6 - Evaluate on test set :</h2>
    <p>Baseline models :</p>
  </li>
</ul>

<p><img src="assets/x22.png" alt="5-22224" />
<img src="assets/x23.png" alt="5-62222" />
<img src="assets/x24.png" alt="5-6223" />
<img src="assets/x25.png" alt="5-6224" /></p>

<p>Xgboost model :
<img src="assets/x1.png" alt="5-22e224" />
<img src="assets/x2.png" alt="5-62e222" />
<img src="assets/x3.png" alt="5e-62e23" />
<img src="assets/x4.png" alt="5e-6224" /></p>

<p>Neural network , regular season :
<img src="assets/reg1.png" alt="5-2222444" />
<img src="assets/reg2.png" alt="5-6222442" />
<img src="assets/reg3.png" alt="5-622443" />
<img src="assets/reg4.png" alt="5-624424" />
<img src="assets/reg5.png" alt="5-624424" />
Neural network , playoffs season :
<img src="assets/off1.png" alt="5-2222444" />
<img src="assets/off2.png" alt="5-6222442" />
<img src="assets/off3.png" alt="5-622443" />
<img src="assets/off4.png" alt="5-624424" />
<img src="assets/off5.png" alt="5-624424" /></p>

<ul>
  <li>First, with an accuracy of 91% and a bias in goal prediction, logistic regression is not performing any better on the testing data than it did last year. The accuracy score for XGBoost is 71. Neural networks remain the top model. </li>
  <li>We noticed that the neural network continues to perform better when tested with the playoff data for the 2019-2020 season. Even though XGBoost (the inferior contender in this testing data) has a greater accuracy of 71% compared to 91% for logistic regression, the latter is still consistently predicting “GOAL”</li>
</ul>

  </div>
  
</div>

<div class="pagination">
  
    <span class="pagination-item older">Older</span>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='/public/js/script.js'></script>
  </body>
</html>
